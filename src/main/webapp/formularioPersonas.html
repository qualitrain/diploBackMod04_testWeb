<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD Personas - Servidor</title>
    <link rel="stylesheet" href="estilos.css">
</head>
<body>
<div class="container">
    <h1>游늶 Gesti칩n de Personas - CRUD Server-Side</h1>

    <!-- Secci칩n para mensajes del servidor -->
    <!-- Estos mensajes se mostrar칤an despu칠s de una redirecci칩n desde el servidor -->
    <div class="message success" style="display: none;" id="serverMessage">
        <!-- El contenido se llenar칤a din치micamente desde el servidor -->
    </div>

    <!-- SECCI칍N 1: Formulario CRUD Principal -->
    <div class="section">
        <h2>游닇 Formulario de Persona</h2>

        <!-- Formulario para CREATE/UPDATE/DELETE -->
        <form method="POST" action="./personas" id="personaForm">
            <!-- Campo oculto para determinar la acci칩n -->
            <input type="hidden" name="action" id="action" value="create">

            <div class="form-group">
                <label for="idPersona">ID Persona:</label>
                <input type="number" id="idPersona" name="idPersona" required min="1"
                       placeholder="Ingrese el id de la persona">
            </div>

            <div class="form-group">
                <label for="nombre">Nombre *</label>
                <input type="text" id="nombre" name="nombre"
                       required maxlength="40"
                       placeholder="Ingrese el nombre (m치x. 40 caracteres)">
            </div>

            <div class="form-group">
                <label for="direccion">Direcci칩n</label>
                <input type="text" id="direccion" name="direccion"
                       maxlength="45"
                       placeholder="Ingrese la direcci칩n (m치x. 45 caracteres)">
            </div>

            <div class="form-group">
                <label for="fechaNacimiento">Fecha de Nacimiento</label>
                <input type="date" id="fechaNacimiento" name="fechaNacimiento">
            </div>

            <div class="form-actions">
                <!-- Estos botones cambiar치n el campo hidden 'action' y enviar치n el formulario -->
                <button type="submit" class="btn-create"
                        onclick="document.getElementById('action').value='create'">
                    Crear Nueva Persona
                </button>

                <button type="submit" class="btn-update"
                        onclick="document.getElementById('action').value='update'">
                    Actualizar Persona
                </button>

                <button type="submit" class="btn-delete"
                        onclick="document.getElementById('action').value='delete'">
                    Eliminar Persona
                </button>

                <button type="button" class="btn-clear" onclick="clearForm()">
                    Limpiar Formulario
                </button>
            </div>
        </form>
    </div>

    <!-- SECCI칍N 2: B칰squeda de Persona -->
    <div class="section">
        <h2>游댌 Buscar Persona por ID</h2>

        <!-- Formulario para b칰squeda (GET) -->
        <form method="GET" action="./personas" id="searchForm">
            <div class="form-group">
                <label for="searchId">ID de Persona:</label>
                <input type="number" id="searchId" name="id"
                       min="1" placeholder="Ingrese el ID a buscar">
            </div>

            <div class="form-actions">
                <button type="submit" class="btn-search">
                    Buscar Persona
                </button>

                <button type="button" class="btn-clear"
                        onclick="window.location.href='/'">
                    Ver Todas las Personas
                </button>
            </div>
        </form>
    </div>

    <!-- SECCI칍N 3: Lista de Personas -->
    <div class="section">
        <h2>游논 Lista de Personas Registradas</h2>

        <!-- Tabla para mostrar resultados -->
        <table id="personasTable">
            <thead>
            <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Direcci칩n</th>
                <th>Fecha Nacimiento</th>
                <th class="actions-cell">Acci칩n</th>
            </tr>
            </thead>
            <tbody>
            <!--
            Esta tabla se llenar칤a desde el servidor.
            Ejemplo de fila que generar칤a el servidor:

            <tr>
                <td>1</td>
                <td>Juan P칠rez</td>
                <td>Calle Principal 123</td>
                <td>1990-05-15</td>
                <td class="actions-cell">
                    <form method="GET" action="/api/personas" style="display: inline;">
                        <input type="hidden" name="id" value="1">
                        <button type="submit" class="btn-select">Seleccionar</button>
                    </form>
                </td>
            </tr>
            -->
            <tr>
                <td colspan="5" style="text-align: center;">
                    Los datos se cargar치n desde el servidor
                </td>
            </tr>
            </tbody>
        </table>

        <!-- Formulario para cargar todas las personas -->
        <div style="margin-top: 20px;">
            <form method="GET" action="/">
                <button type="submit" class="btn-create">
                    Cargar Todas las Personas
                </button>
            </form>
        </div>
    </div>
</div>

<!-- M칤nimo JavaScript necesario -->
<script>
    // Funci칩n para limpiar el formulario
    function clearForm() {
        document.getElementById('personaForm').reset();
        document.getElementById('idPersona').value = '';
        document.getElementById('action').value = 'create';
    }

    // Funci칩n para cargar datos en el formulario (se llamar칤a desde el servidor)
    // Esta funci칩n podr칤a ser generada din치micamente por el servidor
    // cuando env칤a la p치gina con datos espec칤ficos
    function loadPersonaToForm(persona) {
        if (persona) {
            document.getElementById('idPersona').value = persona.idPersona || '';
            document.getElementById('nombre').value = persona.nombre || '';
            document.getElementById('direccion').value = persona.direccion || '';
            document.getElementById('fechaNacimiento').value = persona.fechaNacimiento || '';
            document.getElementById('action').value = 'update';
        }
    }

    // Mostrar mensajes del servidor si existen
    // Este bloque se ejecutar칤a si el servidor incluye mensajes en la p치gina
    window.onload = function() {
        // Ejemplo de c칩mo el servidor podr칤a pasar datos:
        // Si hay par치metros en la URL, podr칤a indicar una operaci칩n exitosa
        const urlParams = new URLSearchParams(window.location.search);
        const message = urlParams.get('message');
        const messageType = urlParams.get('messageType');

        if (message) {
            const messageDiv = document.getElementById('serverMessage');
            messageDiv.textContent = decodeURIComponent(message);
            messageDiv.className = `message ${messageType || 'info'}`;
            messageDiv.style.display = 'block';

            // Ocultar mensaje despu칠s de 5 segundos
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 5000);
        }
    };
</script>
</body>
</html>